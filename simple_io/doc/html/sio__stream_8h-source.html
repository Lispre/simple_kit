<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>sio_stream.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<h1>sio_stream.h</h1><a href="sio__stream_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 <span class="comment">/***************************************************************************</span>
00002 <span class="comment"> * </span>
00003 <span class="comment"> * Copyright (c) 2014 Baidu.com, Inc. All Rights Reserved</span>
00004 <span class="comment"> * $Id$ </span>
00005 <span class="comment"> * </span>
00006 <span class="comment"> **************************************************************************/</span>
00007  
00016 <span class="preprocessor">#ifndef SIMPLE_IO_SIO_STREAM_H</span>
00017 <span class="preprocessor"></span><span class="preprocessor">#define SIMPLE_IO_SIO_STREAM_H</span>
00018 <span class="preprocessor"></span>
00019 <span class="preprocessor">#include "<a class="code" href="sio__buffer_8h.html">sio_buffer.h</a>"</span>
00020 
00021 <span class="preprocessor">#ifdef __cplusplus</span>
00022 <span class="preprocessor"></span><span class="keyword">extern</span> <span class="stringliteral">"C"</span> {
00023 <span class="preprocessor">#endif</span>
00024 <span class="preprocessor"></span>
00025 <span class="comment">// TCP流事件</span>
<a name="l00026"></a><a class="code" href="sio__stream_8h.html#a17">00026</a> <span class="keyword">enum</span> <a class="code" href="sio__stream_8h.html#a17">sio_stream_event</a> {
00027     SIO_STREAM_ACCEPT,        
00028     SIO_STREAM_DATA,          
00029     SIO_STREAM_ERROR,         
00030     SIO_STREAM_CLOSE,         
00031 };
00032 
00033 <span class="keyword">struct </span>sio;
00034 <span class="keyword">struct </span>sio_fd;
00035 <span class="keyword">struct </span>sio_stream;
00036 <span class="keyword">struct </span>sio_buffer;
00037 
00038 <span class="comment">// 用户事件回调</span>
00039 <span class="keyword">typedef</span> void (*sio_stream_callback_t)(<span class="keyword">struct </span>sio *sio, <span class="keyword">struct </span>sio_stream *stream, <span class="keyword">enum</span> <a class="code" href="sio__stream_8h.html#a17">sio_stream_event</a> event, <span class="keywordtype">void</span> *arg);
00040 
00041 <span class="keyword">enum</span> sio_stream_type {
00042     SIO_STREAM_LISTEN,
00043     SIO_STREAM_CONNECT,
00044     SIO_STREAM_NORMAL,
00045 };
00046 
00047 <span class="comment">// 封装TCP连接</span>
00048 <span class="keyword">struct </span>sio_stream {
00049     <span class="keyword">enum</span> sio_stream_type type;        
00050     <span class="keywordtype">int</span> sock;         
00051     <span class="keyword">struct </span>sio_fd *sfd;       
00052     sio_stream_callback_t user_callback;          
00053     <span class="keywordtype">void</span> *user_arg;       
00054     <span class="keyword">struct </span>sio_buffer *inbuf;         
00055     <span class="keyword">struct </span>sio_buffer *outbuf;        
00056 };
00057 
00072 <span class="keyword">struct </span>sio_stream *<a class="code" href="sio__stream_8h.html#a8">sio_stream_listen</a>(<span class="keyword">struct</span> sio *sio, <span class="keyword">const</span> <span class="keywordtype">char</span> *ipv4, uint16_t port, sio_stream_callback_t callback, <span class="keywordtype">void</span> *arg);
00087 <span class="keyword">struct </span>sio_stream *<a class="code" href="sio__stream_8h.html#a9">sio_stream_connect</a>(<span class="keyword">struct</span> sio *sio, <span class="keyword">const</span> <span class="keywordtype">char</span> *ipv4, uint16_t port, sio_stream_callback_t callback, <span class="keywordtype">void</span> *arg);
00101 <span class="keywordtype">void</span> <a class="code" href="sio__stream_8h.html#a10">sio_stream_set</a>(<span class="keyword">struct</span> sio *sio, <span class="keyword">struct</span> sio_stream *stream, sio_stream_callback_t callback, <span class="keywordtype">void</span> *arg);
00113 <span class="keywordtype">void</span> <a class="code" href="sio__stream_8h.html#a11">sio_stream_close</a>(<span class="keyword">struct</span> sio *sio, <span class="keyword">struct</span> sio_stream *stream);
00125 <span class="keywordtype">void</span> <a class="code" href="sio__stream_8h.html#a12">sio_stream_detach</a>(<span class="keyword">struct</span> sio *sio, <span class="keyword">struct</span> sio_stream *stream);
00137 <span class="keywordtype">int</span> <a class="code" href="sio__stream_8h.html#a13">sio_stream_attach</a>(<span class="keyword">struct</span> sio *sio, <span class="keyword">struct</span> sio_stream *stream);
00151 <span class="keywordtype">int</span> <a class="code" href="sio__stream_8h.html#a14">sio_stream_write</a>(<span class="keyword">struct</span> sio *sio, <span class="keyword">struct</span> sio_stream *stream, <span class="keyword">const</span> <span class="keywordtype">char</span> *data, uint64_t size);
00162 <span class="keyword">struct </span>sio_buffer *<a class="code" href="sio__stream_8h.html#a15">sio_stream_buffer</a>(<span class="keyword">struct</span> sio_stream *stream);
00173 uint64_t <a class="code" href="sio__stream_8h.html#a16">sio_stream_pending</a>(<span class="keyword">struct</span> sio_stream *stream);
00174 
00175 <span class="preprocessor">#ifdef __cplusplus</span>
00176 <span class="preprocessor"></span>}
00177 <span class="preprocessor">#endif</span>
00178 <span class="preprocessor"></span>
00179 <span class="preprocessor">#endif  //SIMPLE_IO_SIO_STREAM_H</span>
00180 <span class="preprocessor"></span>
00181 <span class="comment">/* vim: set ts=4 sw=4 sts=4 tw=100 */</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Fri May 30 19:19:48 2014 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
